"Control mated female" = "#64B39B",
"Control cohabiting female" = "#006400",
"Inoculated virgin female" = "#32CD32",
"Inoculated mated female" = "#64B39B",
"Inoculated cohabiting female" = "#006400",
"Control virgin male" = "#FA8072",
"Control mated male" = "#EE2C2C",
"Control cohabiting male" = "#BA251F",
"Inoculated virgin male" = "#FA8072",
"Inoculated mated male" = "#EE2C2C",
"Inoculated cohabiting male" = "#BA251F"
),
breaks = set_breaks, labels = set_labels
) +
scale_linetype_manual(
values = c(
"Control virgin female" = "dashed",
"Control mated female" = "dashed",
"Control cohabiting female" = "dashed",
"Inoculated virgin female" = "solid",
"Inoculated mated female" = "solid",
"Inoculated cohabiting female" = "solid",
"Control virgin male" = "dashed",
"Control mated male" = "dashed",
"Control cohabiting male" = "dashed",
"Inoculated virgin male" = "solid",
"Inoculated mated male" = "solid",
"Inoculated cohabiting male" = "solid"
),
breaks = set_breaks, labels = set_labels
) +
# geom_errorbar(linetype = 'solid', alpha = 0.8, width = 0.6, size = 0.5) +
labs(x = "Days after spray", y = "Survival Probability",
colour = "", linetype = "") +
thm + ylim(0,1) +
facet_wrap(~Mating_status) +
theme_classic()
read.csv("data/SSMI bootstrap.csv") %>%
mutate(int_colour = paste(Mating_status, Sex) %>% tolower(),
tag = paste(Treatment, int_colour)) %>%
mutate(Sex = recode(Sex, "female" = "Female", "male" = "Male"),
Mating_status = factor(Mating_status,
levels = c("Cohabiting","Virgin","Mated"))) %>%
ggplot(aes(x = Day, y = est, ymin = lower, ymax = upper,
linetype = tag, colour = tag, group = tag)) +
geom_line(size = 0.9) +
geom_point(size = 1) +
scale_colour_manual(
values = c(
"Control virgin female" = "#32CD32",
"Control mated female" = "#64B39B",
"Control cohabiting female" = "#006400",
"Inoculated virgin female" = "#32CD32",
"Inoculated mated female" = "#64B39B",
"Inoculated cohabiting female" = "#006400",
"Control virgin male" = "#FA8072",
"Control mated male" = "#EE2C2C",
"Control cohabiting male" = "#BA251F",
"Inoculated virgin male" = "#FA8072",
"Inoculated mated male" = "#EE2C2C",
"Inoculated cohabiting male" = "#BA251F"
),
breaks = set_breaks, labels = set_labels
) +
scale_linetype_manual(
values = c(
"Control virgin female" = "dashed",
"Control mated female" = "dashed",
"Control cohabiting female" = "dashed",
"Inoculated virgin female" = "solid",
"Inoculated mated female" = "solid",
"Inoculated cohabiting female" = "solid",
"Control virgin male" = "dashed",
"Control mated male" = "dashed",
"Control cohabiting male" = "dashed",
"Inoculated virgin male" = "solid",
"Inoculated mated male" = "solid",
"Inoculated cohabiting male" = "solid"
),
breaks = set_breaks, labels = set_labels
) +
geom_errorbar(linetype = 'solid', alpha = 0.8, width = 0.6, size = 0.5) +
labs(x = "Days after spray", y = "Survival Probability",
colour = "", linetype = "") +
thm + ylim(0,1) +
facet_wrap(~Mating_status) +
theme_classic()
read.csv("data/SSMI bootstrap.csv") %>%
mutate(int_colour = paste(Mating_status, Sex) %>% tolower(),
tag = paste(Treatment, int_colour)) %>%
mutate(Sex = recode(Sex, "female" = "Female", "male" = "Male"),
Mating_status = factor(Mating_status,
levels = c("Cohabiting","Virgin","Mated"))) %>%
ggplot(aes(x = Day, y = est, ymin = lower, ymax = upper,
linetype = tag, colour = tag, group = tag)) +
geom_line(size = 0.9) +
geom_point(size = 1) +
scale_colour_manual(
values = c(
"Control virgin female" = "#32CD32",
"Control mated female" = "#64B39B",
"Control cohabiting female" = "#006400",
"Inoculated virgin female" = "#32CD32",
"Inoculated mated female" = "#64B39B",
"Inoculated cohabiting female" = "#006400",
"Control virgin male" = "#FA8072",
"Control mated male" = "#EE2C2C",
"Control cohabiting male" = "#BA251F",
"Inoculated virgin male" = "#FA8072",
"Inoculated mated male" = "#EE2C2C",
"Inoculated cohabiting male" = "#BA251F"
),
breaks = set_breaks, labels = set_labels
) +
scale_linetype_manual(
values = c(
"Control virgin female" = "dashed",
"Control mated female" = "dashed",
"Control cohabiting female" = "dashed",
"Inoculated virgin female" = "solid",
"Inoculated mated female" = "solid",
"Inoculated cohabiting female" = "solid",
"Control virgin male" = "dashed",
"Control mated male" = "dashed",
"Control cohabiting male" = "dashed",
"Inoculated virgin male" = "solid",
"Inoculated mated male" = "solid",
"Inoculated cohabiting male" = "solid"
),
breaks = set_breaks, labels = set_labels
) +
# geom_errorbar(linetype = 'solid', alpha = 0.8, width = 0.6, size = 0.5) +
labs(x = "Days after spray", y = "Survival Probability",
colour = "", linetype = "") +
thm + ylim(0,1) +
facet_wrap(~Mating_status) +
theme_classic()
df = read.csv("data/SSMI raw.csv") %>%
mutate(Mating_status = recode(Mating_status, "Cohabit" = "Cohabiting"),
Treatment = recode(Treatment, "Fungal" = "Inoculated")) %>%
filter(Mating_status != "Virgin CO2") %>%
droplevels() %>%
mutate(sex = ifelse(Sex=="F", "female", "male"),
tag = as.factor(paste(Treatment, tolower(Mating_status), sex)))
surv_df =
df %>%
group_by(Mating_status,Sex,tag,Treatment) %>%
mutate(total = length(Death)) %>%
group_by(Mating_status,Sex,tag,Treatment,Day,total) %>%
summarise(Death = sum(Death)) %>%
group_by(Mating_status,Sex,tag, Treatment,total) %>%
mutate(Death=cumsum(Death)) %>%
mutate(surv_per = 100*(1-Death/total))
surv_rep =
df %>%
group_by(Replicate,Mating_status,Sex,tag,Treatment) %>%
mutate(total = length(Death)) %>%
group_by(Replicate,Mating_status,Sex,tag,Treatment,Day,total) %>%
summarise(Death = sum(Death)) %>%
group_by(Replicate,Mating_status,Sex,tag, Treatment,total) %>%
mutate(Death=cumsum(Death)) %>%
mutate(surv_per = 100*(1-Death/total))
ggplot(data=NULL,
aes(x=Day, y=surv_per, linetype=tag, color=tag, group=tag)) +
geom_line(data=surv_df, size = 1, alpha = 0.5) +
geom_point(data=surv_rep, size = 0.6) +
scale_color_manual(
values = c(
"Control virgin female" = "#32CD32",
"Control mated female" = "#64B39B",
"Control cohabiting female" = "#006400",
"Inoculated virgin female" = "#32CD32",
"Inoculated mated female" = "#64B39B",
"Inoculated cohabiting female" = "#006400",
"Control virgin male" = "#FA8072",
"Control mated male" = "#EE2C2C",
"Control cohabiting male" = "#BA251F",
"Inoculated virgin male" = "#FA8072",
"Inoculated mated male" = "#EE2C2C",
"Inoculated cohabiting male" = "#BA251F"
),
breaks = set_breaks, labels = set_labels
) +
scale_linetype_manual(
values = c(
"Control virgin female" = "dashed",
"Control mated female" = "dashed",
"Control cohabiting female" = "dashed",
"Inoculated virgin female" = "solid",
"Inoculated mated female" = "solid",
"Inoculated cohabiting female" = "solid",
"Control virgin male" = "dashed",
"Control mated male" = "dashed",
"Control cohabiting male" = "dashed",
"Inoculated virgin male" = "solid",
"Inoculated mated male" = "solid",
"Inoculated cohabiting male" = "solid"
),
breaks = set_breaks, labels = set_labels
) +
labs(linetype="", color="",
y = "Survival Percent (%)", color="Mating Status",
x = "Days after spray") +
ylim(0,100) +
theme_classic() +
facet_grid(~Mating_status)
reps <- read.csv("data/SSMI larva.csv")
model <- lm(larvaPsurv ~ Day + Treatment + Mating_status +
Treatment:Mating_status + Day:Treatment, reps)
tb_fit <- reps %>% select(Day, Treatment, Mating_status) %>% unique()
tb_fit <- cbind(tb_fit, predict(model, tb_fit, interval = "confidence")) %>%
mutate()
ggplot(data = tb_fit,
aes(x = Day, y = fit, ymin = lwr, ymax = upr,
linetype = Treatment, color = Mating_status,
group = interaction(Treatment, Mating_status))) +
geom_line(size=1.2, show.legend=FALSE) +
geom_point(size=1.5, show.legend=FALSE) +
geom_errorbar(size=0.5, width=0.5, show.legend=FALSE) +
scale_linetype_manual(values=c("Control"="dashed","Fungal"="solid")) +
scale_color_manual(values = c("Cohabit"="#006400", "Mated"="#64B39B")) +
thm +
labs(x="Days after spray", y="Offspring count per surviving female")
ggplot(data = tb_fit,
aes(x = Day, y = fit, ymin = lwr, ymax = upr,
linetype = Treatment, color = Mating_status,
group = interaction(Treatment, Mating_status))) +
geom_line(size=1.2, show.legend=FALSE) +
geom_point(size=1.5, show.legend=FALSE) +
geom_errorbar(size=0.5, width=0.5, show.legend=FALSE) +
scale_linetype_manual(values=c("Control"="dashed","Fungal"="solid")) +
scale_color_manual(values = c("Cohabit"="#006400", "Mated"="#64B39B")) +
thm +
labs(x = "Days after spray",
y = "Offspring count per surviving female per day")
ggplot(data = tb_fit,
aes(x = Day, y = fit, ymin = lwr, ymax = upr,
linetype = Treatment, color = Mating_status,
group = interaction(Treatment, Mating_status))) +
geom_line(size=1.2, show.legend=FALSE) +
geom_point(size=1.5, show.legend=FALSE) +
geom_errorbar(size=0.5, width=0.5, show.legend=FALSE) +
scale_linetype_manual(values=c("Control"="dashed","Fungal"="solid")) +
scale_color_manual(values = c("Cohabit"="#006400", "Mated"="#64B39B")) +
theme_minimal() +
labs(x = "Days after spray",
y = "Offspring count per surviving female per day")
ggplot(data = tb_fit,
aes(x = Day, y = fit, ymin = lwr, ymax = upr,
linetype = Treatment, color = Mating_status,
group = interaction(Treatment, Mating_status))) +
geom_line(size=1.2, show.legend=FALSE) +
geom_point(size=1.5, show.legend=FALSE) +
geom_errorbar(size=0.5, width=0.5, show.legend=FALSE) +
scale_linetype_manual(values=c("Control"="dashed","Fungal"="solid")) +
scale_color_manual(values = c("Cohabit"="#006400", "Mated"="#64B39B")) +
theme_classic() +
labs(x = "Days after spray",
y = "Offspring count per surviving female per day")
ggplot(data = tb_fit,
aes(x = Day, y = fit, ymin = lwr, ymax = upr,
linetype = Treatment, color = Mating_status,
group = interaction(Treatment, Mating_status))) +
geom_line(size=1.2,) +
geom_point(size=1.5) +
geom_errorbar(size=0.5, width=0.5) +
scale_linetype_manual(values=c("Control"="dashed","Fungal"="solid")) +
scale_color_manual(values = c("Cohabit"="#006400", "Mated"="#64B39B")) +
theme_classic() +
labs(x = "Days after spray",
y = "Offspring count per surviving female per day")
View(tb_fit)
reps <- read.csv("data/SSMI larva.csv")
model <- lm(larvaPsurv ~ Day + Treatment + Mating_status +
Treatment:Mating_status + Day:Treatment, reps)
tb_fit <- reps %>% select(Day, Treatment, Mating_status) %>% unique()
tb_fit <- cbind(tb_fit, predict(model, tb_fit, interval = "confidence")) %>%
mutate(tag = paste(Treatment, tolower(Mating_status)))
ggplot(data = tb_fit,
aes(x = Day, y = fit, ymin = lwr, ymax = upr,
linetype = tag, color = tag, group = tag)) +
geom_line(size=1.2,) +
geom_point(size=1.5) +
# geom_errorbar(size=0.5, width=0.5) +
scale_linetype_manual(values=c("Control"="dashed","Fungal"="solid")) +
scale_color_manual(values = c("Cohabit"="#006400", "Mated"="#64B39B")) +
theme_classic() +
labs(x = "Days after spray",
y = "Offspring count per surviving female per day")
ggplot(data = tb_fit,
aes(x = Day, y = fit, ymin = lwr, ymax = upr,
linetype = tag, color = tag, group = tag)) +
geom_line(size=1.2,) +
geom_point(size=1.5)
ggplot(data = tb_fit,
aes(x = Day, y = fit, ymin = lwr, ymax = upr,
linetype = tag, color = tag, group = tag)) +
geom_line(size = 0.9) +
geom_point(size = 1)
levels(tb_fit$tag)
tb_fit <- cbind(tb_fit, predict(model, tb_fit, interval = "confidence")) %>%
mutate(tag = as.factor(paste(Treatment, tolower(Mating_status))))
reps <- read.csv("data/SSMI larva.csv")
model <- lm(larvaPsurv ~ Day + Treatment + Mating_status +
Treatment:Mating_status + Day:Treatment, reps)
tb_fit <- reps %>% select(Day, Treatment, Mating_status) %>% unique()
tb_fit <- cbind(tb_fit, predict(model, tb_fit, interval = "confidence")) %>%
mutate(tag = as.factor(paste(Treatment, tolower(Mating_status))))
levels(tb_fit$tag)
reps <- read.csv("data/SSMI larva.csv") %>%
mutate(Treatment = recode(Treatment, "Fungal" = "Inoculated"))
model <- lm(larvaPsurv ~ Day + Treatment + Mating_status +
Treatment:Mating_status + Day:Treatment, reps)
tb_fit <- reps %>% select(Day, Treatment, Mating_status) %>% unique()
tb_fit <- cbind(tb_fit, predict(model, tb_fit, interval = "confidence")) %>%
mutate(tag = as.factor(paste(Treatment, tolower(Mating_status))))
levels(tb_fit$tag)
set_breaks = c("Control cohabit", "Inoculated cohabit",
"Control mated", "Inoculated mated")
ggplot(data = tb_fit,
aes(x = Day, y = fit, ymin = lwr, ymax = upr,
linetype = tag, color = tag, group = tag)) +
geom_line(size = 0.9) +
geom_point(size = 1)
ggplot(data = tb_fit,
aes(x = Day, y = fit, ymin = lwr, ymax = upr,
linetype = tag, color = tag, group = tag)) +
geom_line(size = 0.9) +
geom_point(size = 1) +
# geom_errorbar(size=0.5, width=0.5) +
scale_linetype_manual(values=c("Control"="dashed","Fungal"="solid")) +
scale_color_manual(values = c("Cohabit"="#006400", "Mated"="#64B39B")) +
theme_classic() +
labs(x = "Days after spray",
y = "Offspring count per surviving female per day")
ggplot(data = tb_fit,
aes(x = Day, y = fit, ymin = lwr, ymax = upr,
linetype = tag, color = tag, group = tag)) +
geom_line(size = 0.9) +
geom_point(size = 1) +
# geom_errorbar(size=0.5, width=0.5) +
scale_linetype_manual(
values = c(
"Control cohabit" = "dashed",
"Inoculated cohabit" = "solid",
"Control mated" = "dashed",
"Inoculated mated" = "solid"
)
) +
scale_color_manual(values = c("Cohabit"="#006400", "Mated"="#64B39B")) +
theme_classic() +
labs(x = "Days after spray",
y = "Offspring count per surviving female per day")
ggplot(data = tb_fit,
aes(x = Day, y = fit, ymin = lwr, ymax = upr,
linetype = tag, color = tag, group = tag)) +
geom_line(size = 0.9) +
geom_point(size = 1) +
# geom_errorbar(size=0.5, width=0.5) +
scale_linetype_manual(
values = c(
"Control cohabit" = "dashed",
"Inoculated cohabit" = "solid",
"Control mated" = "dashed",
"Inoculated mated" = "solid"
),
breaks = set_breaks
) +
scale_color_manual(
values = c(
"Control cohabit" = "#006400",
"Inoculated cohabit" = "#006400",
"Control mated" = "#64B39B",
"Inoculated mated" = "#64B39B"
),
breaks = set_breaks
) +
theme_classic() +
labs(x = "Days after spray",
y = "Offspring count per surviving female per day")
ggplot(data = tb_fit,
aes(x = Day, y = fit, ymin = lwr, ymax = upr,
linetype = tag, color = tag, group = tag)) +
geom_line(size = 0.9) +
geom_point(size = 1) +
geom_errorbar(size=0.5, width=0.5) +
scale_linetype_manual(
values = c(
"Control cohabit" = "dashed",
"Inoculated cohabit" = "solid",
"Control mated" = "dashed",
"Inoculated mated" = "solid"
),
breaks = set_breaks
) +
scale_color_manual(
values = c(
"Control cohabit" = "#006400",
"Inoculated cohabit" = "#006400",
"Control mated" = "#64B39B",
"Inoculated mated" = "#64B39B"
),
breaks = set_breaks
) +
theme_classic() +
labs(x = "Days after spray",
y = "Offspring count per surviving female per day")
#
ggplot(data = tb_fit,
aes(x = Day, y = fit, ymin = lwr, ymax = upr,
linetype = tag, color = tag, group = tag)) +
geom_line(size = 0.9) +
geom_point(size = 1) +
# geom_errorbar(size=0.5, width=0.5) +
scale_linetype_manual(
values = c(
"Control cohabit" = "dashed",
"Inoculated cohabit" = "solid",
"Control mated" = "dashed",
"Inoculated mated" = "solid"
),
breaks = set_breaks
) +
scale_color_manual(
values = c(
"Control cohabit" = "#006400",
"Inoculated cohabit" = "#006400",
"Control mated" = "#64B39B",
"Inoculated mated" = "#64B39B"
),
breaks = set_breaks
) +
theme_classic() +
labs(x = "Days after spray",
y = "Offspring count per surviving female per day")
df =
read.csv("./data/DIET 2 bootstrap.csv") %>%
select(-X) %>%
mutate(Diet = factor(Diet, levels=c("C/C","C/G","G/G","G/C"))) %>%
select(c(Treatment,Sex,Diet,Sex,day,est,lower,upper))
df_initial =
df %>%
select(-c(day,est,lower,upper)) %>%
unique() %>%
mutate(day=0, est=1, lower=1, upper=1)
labels = read.csv("./data/DIET 2 raw.csv") %>%
mutate(Diet = factor(Diet, levels=c("C/C","C/G","G/G","G/C"))) %>%
filter(Day==1) %>%
group_by(Diet,Treatment,Sex) %>%
summarise(Initial=sum(Initial.density))
plot_fun4 = function(d){
set_label =
labels %>%
filter(Diet==d) %>%
mutate(Sex = ifelse(Sex=="M", "Male","Female"),
Sex = factor(Sex, levels=c("Male","Female")),
tag = paste0(Treatment," ",Sex, " (n=",Initial,")")) %>%
arrange(Treatment,Sex)
bind_rows(df,df_initial) %>%
filter(Diet == d) %>%
mutate(tag = factor(paste(Treatment, Sex),
levels=c("Control Male","Control Female",
"Fungal Male","Fungal Female"))) %>%
ggplot(aes(x=day, y=est, ymin=lower, ymax=upper, color=tag, linetype=tag,
group=interaction(Diet,tag))) +
geom_errorbar(width=0.5,size=0.5,alpha=0.7) +
geom_line(size=1) +
geom_point(size=1) +
scale_x_continuous(breaks=seq(0,12,4)) +
scale_linetype_manual(values=c("Control Female"="dotted",
"Control Male"="dotted",
"Fungal Female"="solid",
"Fungal Male"="solid"),
labels=set_label$tag) +
scale_color_manual(values=c("Control Female"="darkgreen",
"Control Male"="brown",
"Fungal Female"="darkgreen",
"Fungal Male"="brown"),
labels=set_label$tag) +
facet_grid(~Diet) +
labs(x="Days after spray", y="Survival Probability", color="", linetype="") +
theme_classic()
}
plot_fun4("C/C")
plot_fun4("C/G")
plot_fun4("C/C")
plot_fun4("C/G")
plot_fun4("C/C") + ylim(0.5 + 1)
plot_fun4("C/C") + ylim(0.5,1)
plot_fun4("C/C") + ylim(0.5,1)
plot_fun4("C/G") + ylim(0.5,1)
plot_fun4("G/G") + ylim(0.5,1)
plot_fun4("G/C") + ylim(0.5,1)
df =
read.csv("./data/DIET 2 bootstrap.csv") %>%
select(-X) %>%
mutate(Diet = factor(Diet, levels=c("C/C","C/G","G/G","G/C"))) %>%
select(c(Treatment,Sex,Diet,Sex,day,est,lower,upper))
df_initial =
df %>%
select(-c(day,est,lower,upper)) %>%
unique() %>%
mutate(day=0, est=1, lower=1, upper=1)
labels = read.csv("./data/DIET 2 raw.csv") %>%
mutate(Diet = factor(Diet, levels=c("C/C","C/G","G/G","G/C"))) %>%
filter(Day==1) %>%
group_by(Diet,Treatment,Sex) %>%
summarise(Initial=sum(Initial.density))
plot_fun4("C/C") + ylim(0.5,1)
plot_fun4("C/G") + ylim(0.5,1)
plot_fun4("G/G") + ylim(0.5,1)
plot_fun4("G/C") + ylim(0.5,1)
